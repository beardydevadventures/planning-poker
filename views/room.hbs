<p id="roomNo">The message</p>
<ul id="messages"></ul>
<form action="">
    <input id="m" autocomplete="off" /><button>Send</button>
</form>

{{> scripts}}
<script>
    $(function () {
        let hash = '';
        if (window.location.hash) {
            hash = window.location.hash.substring(1);
            roomController(hash);
        } else {
            window.location.href = "/";
        }
    });

    function roomController(hash) {
        const socket = io();

        socket.emit('connectToRoom', hash);

        socket.on('connectedToRoom', function (response) {
            $('#roomNo').innerHTML = '';
            $('#roomNo').text(response);
        });

        $('form').submit(function (e) {
            e.preventDefault(); // prevents page reloading
            socket.emit('chat message', { "room": hash, "message": $('#m').val() });
            $('#m').val('');
            return false;
        });

        socket.on('chat message', function (msg) {
            $('#messages').append($('<li>').text(msg));
        });
    }
</script>